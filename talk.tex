\documentclass[aspectratio=169]{beamer}
% handout % for printing slides
\usetheme{Informatics}

\usepackage[backend=biber, style=ieee, maxcitenames=6]{biblatex}
\addbibresource{bib.bib}
\usepackage{csquotes}

\usepackage{tikz}
\usepackage{tikz-3dplot}
\usepackage{tikzpeople}
\usetikzlibrary{arrows, arrows.meta, fadings, fit, backgrounds, calc, math, decorations.markings, decorations.text, intersections, patterns, bending, positioning, shapes, shapes.geometric}
% set up externalization
\usetikzlibrary{external}
\tikzexternalize[prefix=Tikz/]
\tikzset{%
  external/only named=true,
  block/.style = {draw, rounded corners=2ex, outer sep=0, minimum width=2.2cm, fill=white},%
  masterBlock/.style = {fill, rectangle, inner sep=0.1*\U, rounded corners=2ex, fill=infoBlue!20!white},
  frame/.style={rectangle, draw, minimum width=5em, text centered, minimum height=3.6em, fill=white, rounded corners, align=center},
  line/.style={draw, -{Latex}},
}
\usepackage{pgfplots}
\usepackage{pgfplotstable}
\pgfplotsset{compat=newest}
\pgfplotsset{%
  % grid=both,
  tick align=outside,
  tick pos=left,
  major tick length=2pt,
  xlabel shift = -3 pt,
  ylabel shift = -3 pt,
  % enlargelimits=false,
  every axis plot/.append style={%
      font=\footnotesize,
  }, % line
  legend cell align={left},
  every axis legend/.append style={%
      font=\footnotesize,
  },
  every tick label/.append style={%
      font=\footnotesize,
  },
}
\usepackage{countriesofeurope}
\usepackage{fontawesome}
\usepackage{subcaption}
\makeatletter
\newcommand{\getLength}[4]{%
    \pgfmathanglebetweenpoints{\pgfpointanchor{#1}{#2}}
                              {\pgfpointanchor{#3}{#4}}
    \global\let\myangle\pgfmathresult % we need a global macro
    \pgfpointdiff{\pgfpointanchor{#1}{#2}}
                {\pgfpointanchor{#3}{#4}}
    \pgf@xa=\pgf@x % no need to use a new dimen
    \pgf@ya=\pgf@y
    \pgfmathparse{veclen(\pgf@xa,\pgf@ya)/28.45274} % to convert from pt to cm
    \global\let\mylength\pgfmathresult % we need a global macro
}
\makeatother 

\usepackage{siunitx}
\usepackage{bm}
\usepackage{xcolor}
\colorlet{myorange}{orange!80!black}
\colorlet{myred}{red!80!black}
\colorlet{myblue}{blue!80!black}
\colorlet{mygreen}{green!60!black}
\colorlet{mydarkred}{red!30!black}
\colorlet{mydarkblue}{blue!40!black}
\colorlet{mydarkgreen}{green!30!black}
\usepackage{listofitems} % for \readlist

\usepackage{wrapfig}
\usepackage{multirow}
\usepackage{multicol}
\usepackage{makecell}
\usepackage{qrcode}
\usepackage{hyperref}
\usepackage{multimedia}
\newcommand{\heightVideo}{6.0cm}
\newcommand{\heightVideoFull}{7.0cm}

\newrobustcmd*{\footfullcitenomark}{% 
  \AtNextCite{%
    \let\thefootnote\relax
    \let\mkbibfootnote\mkbibfootnotetext
  }
  \footfullcite%
}
\title{Deploying multi-contact manipulation}
\subtitle{Towards achieving dynamic contact-rich manipulation behaviours}
\author{\textbf{Jo\~{a}o Moura}}
\date{\today}


\makeatletter
\def\calcLength(#1,#2)#3{%
\pgfpointdiff{\pgfpointanchor{#1}{center}}%
             {\pgfpointanchor{#2}{center}}%
\pgf@xa=\pgf@x%
\pgf@ya=\pgf@y%
\FPeval\@temp@a{\pgfmath@tonumber{\pgf@xa}}%
\FPeval\@temp@b{\pgfmath@tonumber{\pgf@ya}}%
\FPeval\@temp@sum{(\@temp@a*\@temp@a+\@temp@b*\@temp@b)}%
\FProot{\FPMathLen}{\@temp@sum}{2}%
\FPround\FPMathLen\FPMathLen5\relax
\global\expandafter\edef\csname #3\endcsname{\FPMathLen}
}
\makeatother

\begin{document}

\input{Tikz/tikz_nodes.tex}
% remove Figure from figures caption
\setbeamertemplate{caption}{\raggedright\insertcaption\par}

\begin{frame}[plain,noframenumbering]
  \maketitle
\end{frame}

% Outline frame
\begin{frame}{Outline}
    \tableofcontents
\end{frame}

\section{Manipulation Workshop}

\begin{frame}{UK Robot Manipulation Workshop\footnote{\href{https://www.robot-manipulation.uk}{www.robot-manipulation.uk}}}
  \begin{center}
    \begin{figure}
      \fbox{\includegraphics[width=0.8\textwidth]{images/uk_robot_manipulation.jpg}}
    \end{figure}
  \end{center}
\end{frame}

\section{Research discussion}

\begin{frame}[t]
  \begin{columns}[T]
    \begin{column}{0.55\textwidth}
      \centering
      \begin{figure}
        \only<1>{
          \tikzsetnextfilename{fig_landscape_taskspace_contactfree}
          \input{Tikz/fig_landscape_taskspace_contactfree.tex}
        }
        \only<2->{
          \tikzsetnextfilename{fig_landscape_taskspace_contactrich}
          \input{Tikz/fig_landscape_taskspace_contactrich.tex}
        }
      \end{figure}
    \end{column}
    \begin{column}{0.45\textwidth}
      \vspace*{5mm}
      \begin{itemize}
        \item<only@3-> \textbf{\textcolor{infoRed}{Hybrid dynamics}} from \textbf{contact modes}
        \item<only@4-> \textbf{\textcolor{infoRed}{Underactuation}} requiring \textbf{prediction} of object dynamics
        \item<only@5-> Large \textbf{\textcolor{infoRed}{Sim2Real gap}} with high \textbf{uncertainty} from hard-to-model \textbf{contact and frictional interactions}
      \end{itemize}
    \end{column}
  \end{columns}
\end{frame}

\begin{frame}[t]{Contact-rich Manipulation}{Hybrid Trajectory Optimization}
  \begin{columns}[T]
    \begin{column}{0.45\textwidth}
      \begin{figure}
        \centering
        \only{\includegraphics[width=0.9\textwidth]{images/theo_contact_plot.jpg}}<1-2>
        \only{\includegraphics[width=0.9\textwidth]{images/theo_hybrid_trajectory_schematic.jpg}}<3>
      \end{figure}
    \end{column}
    \begin{column}{0.55\textwidth}
      \only{
        {\footnotesize
        \begin{align*}
            &\min_{x(t),u(t)} &\quad & \int_0^T c(x(t),u(t))dt + c_f(x(T)) &\text{(\textcolor{infoRed}{cost})}\\
            &\text{subject to}&      & \dot{x}(t)=f(x(t), u(t)),           &\text{(\textcolor{infoRed}{dynamics})}\\
            &                 &      & x(0)\in\mathbb{X}_0,                &\text{(\textcolor{infoRed}{start})}\\
            &                 &      & x(T)\in\mathbb{X}_T,                &\text{(\textcolor{infoRed}{end})}\\
      \only{&                 &      & g(x(t), u(t))\in\mathbb{Z},         &\text{(\textcolor{infoRed}{hybrid})}\\}<1-2>
      \only{&                 &      & \textcolor{infoRed}{g(x(t), u(t))\in\mathbb{Z}},         &\text{(\textcolor{infoRed}{hybrid})}\\}<3>
            &                 &      & t\in[0,T].                          &\text{(\textcolor{infoRed}{time})}
        \end{align*}
        }
      }<2->
    \end{column}
  \end{columns}
  \footfullcitenomark{Stouraitis2018}
  \footfullcitenomark{Stouraitis2020a}
\end{frame}

\begin{frame}{Contact-rich Manipulation}{Hybrid Trajectory Optimization}
  \centering
  \movie[
    label=theovideo,
    height=\heightVideo,
    % autostart,
    % repeat,
    showcontrols,
  ]{\includegraphics[height=\heightVideo]{images/theo_tro.png}}{videos/theo_tro.mp4}
  \footfullcitenomark{Stouraitis2018}
  \footfullcitenomark{Stouraitis2020a}
\end{frame}

\begin{frame}[t]{Contact-rich Manipulation}{Catching fast, large, and heavy boxes}
  \begin{columns}[T]
    \begin{column}{0.4\textwidth}
      \vspace*{-1.0cm}
      % \hspace*{0.5cm}
      \centering
      {\tiny
        \def\svgwidth{0.7\linewidth}
        \input{Tikz/Concept_mininal}
      }
    \end{column}
    \begin{column}{0.6\textwidth}
      \centering
      \vspace*{1.0cm}
      \only{
        Given a sequence modes $\bm{\mathcal{M}}: \{ \mathcal{M}_0, \mathcal{M}_1, ... \mathcal{M}_M \}$, we solve the follwoing Multi-Mode \textbf{Trajectory Optimization}:
        {\small
        \begin{align*}
            &\min_{x_i,u_i} &\quad& C(x_{0:N},u_{0:N-1})                &\text{(\textcolor{infoRed}{cost})}\\
            &\text{subject to}            &     & x_{i+1}=f(x_i, u_i, \mathcal{M}_n), &\text{(\textcolor{infoRed}{dynamics})}\\
            &                             &     & g(x_i, u_i, \mathcal{M}_n) \leq 0.  &\text{(\textcolor{infoRed}{constraints})}
        \end{align*}
        }
      }<2->
    \end{column}
  \end{columns}
  \begin{tikzpicture}[overlay, remember picture]
    % photos of colaborators
    \node[anchor=south east] (theo) at (current page.south east) [xshift=-3mm, yshift=10mm] {
      \includegraphics[height=1.4cm]{images/Theo.png}
    };
    \node (theoName) at (theo.south) [anchor=north, text width=3.5cm, align=center] {
      \textcolor{infoBlue}{\scriptsize\textbf{Theo}}
    };
    \draw[very thick, infoBlue] (theo) circle (0.7cm);
    % -----
    \node[anchor=east] (lei) at (theo.west) [xshift=-5mm] {
      \includegraphics[height=1.4cm]{images/lei.png}
    };
    \node (leiName) at (lei.south) [anchor=north, text width=3.5cm, align=center] {
      \textcolor{infoBlue}{\scriptsize\textbf{Lei}}
    };
    \draw[very thick, infoBlue] (lei) circle (0.7cm);
  \end{tikzpicture}
  \footfullcitenomark{Yan2024}
\end{frame}

\begin{frame}{Contact-rich Manipulation}{Catching fast, large, and heavy boxes}
  \centering
  \begin{figure}[h]
    \movie[
      % showcontrols,
      label=catchingFlyingBox,
      height=\heightVideoFull,
    ]{\includegraphics[height=\heightVideoFull]{images/catchingFlyingBox.png}}{videos/catchingFlyingBox.mp4}
  \end{figure}
  \vspace*{-5mm}
  {\scriptsize box speed of over~$3.0\,\si{\meter\per\second}$; box mass of~$4\,\si{\kilo\gram}$}
  \footfullcitenomark{Yan2024}
\end{frame}

\begin{frame}{Contact-rich Manipulation}{Catching fast, large, and heavy boxes}
  \centering
  \begin{figure}[h]
    \movie[
      showcontrols,
      label=catchingEvolution,
      height=\heightVideoFull,
    ]{\includegraphics[height=\heightVideoFull]{images/catchingEvolution.png}}{videos/catchingEvolution.mp4}
  \end{figure}
  \vspace*{-5mm}
  \footfullcitenomark{Yan2024}
\end{frame}

\begin{frame}{Contact-rich Manipulation}{Catching fast, large, and heavy boxes}
  \begin{columns}[T]
    \begin{column}{0.5\textwidth}
      \begin{center}
        \begin{figure}[h]
          \centering
          \movie[
            showcontrols,
            label=catchingStiffnessOnly,
            height=0.55\textwidth,
          ]{\includegraphics[height=0.55\textwidth]{images/catchingStiffnessOnly.png}}{videos/catchingStiffnessOnly.mp4}
        \end{figure}
        {\scriptsize low stiffness only}
      \end{center}
    \end{column}
    \begin{column}{0.5\textwidth}
      \begin{center}
        \begin{figure}[h]
          \movie[
            showcontrols,
            label=catchingImpactAware,
            height=0.55\textwidth,
          ]{\includegraphics[height=0.55\textwidth]{images/catchingImpactAware.png}}{videos/catchingImpactAware.mp4}
        \end{figure}
        {\scriptsize \textbf{impact-aware planning}}
      \end{center}
    \end{column}
  \end{columns}
  \begin{center}
    {\scriptsize box speed of~$0.66\,\si{\meter\per\second}$; box mass of~$20\,\si{\kilo\gram}$}
  \end{center}
  \footfullcitenomark{Stouraitis2020b}
\end{frame}

\begin{frame}[t]{Contact-rich Manipulation}{MPC for non-prehensile pushing}
  \begin{columns}[T]
    \begin{column}{0.4\textwidth}
      \begin{figure}
        \centering
        \tikzsetnextfilename{fig_robot_box_slider}
        \input{Tikz/fig_robot_box_slider.tex}
      \end{figure}
    \end{column}
    \begin{column}{0.6\textwidth}
      \only{
        \centering
        \begin{figure}
          \begin{subfigure}{0.30\textwidth}
            \centering
            \tikzsetnextfilename{fig_mode_sticking}
            \input{Tikz/fig_mode_sticking.tex}
            \vskip-1.0em
            \caption*{\footnotesize Sticking}
          \end{subfigure}
          \begin{subfigure}{0.30\textwidth}
            \centering
            \tikzsetnextfilename{fig_mode_sliding_counterclockwise}
            \input{Tikz/fig_mode_sliding_counterclockwise.tex}
            \vskip-1.0em
            \caption*{\footnotesize Sliding Left}
          \end{subfigure}
          \begin{subfigure}{0.30\textwidth}
            \centering
            \tikzsetnextfilename{fig_mode_sliding_clockwise}
            \input{Tikz/fig_mode_sliding_clockwise.tex}
            \vskip-1.0em
            \caption*{\footnotesize Sliding Right}
          \end{subfigure}
        \end{figure}
        \vspace*{5mm}
      }<2->
      \only{
        Mathematical Program with Complementarity Constraints (MPCC):
        {\small
        \begin{align*}
            &\min_{x_i,u_i,\varepsilon_i} &\quad& C(x_{0:N},u_{0:N-1},\varepsilon_{0:N-1})&\text{(\textcolor{infoRed}{cost})}\\
            &\text{subject to} &      & x_{i+1}=f(x_i, u_i),&\text{(\textcolor{infoRed}{dynamics})}\\
            &                  &      & x_i\in\mathcal{X},&\text{(\textcolor{infoRed}{state constraints})}\\
            &                  &      & u_i\in\mathcal{U}_0,&\text{(\textcolor{infoRed}{unilaterality})}\\
            &                  &      & u_i,\varepsilon_i\in\mathcal{U}_{cc},&\text{(\textcolor{infoRed}{complementarity})}
        \end{align*}
        }
      }<3->
    \end{column}
  \end{columns}
  \vspace*{-20mm}
  \footfullcitenomark{Moura2022}
\end{frame}


\begin{frame}{Contact-rich Manipulation}{MPC for non-prehensile pushing}
  \centering
  \movie[
    label=testmovie,
    height=\heightVideoFull,
    % autostart,
    % repeat,
    showcontrols
  ]{\includegraphics[height=\heightVideoFull]{images/rviz_harmony_video.png}}{videos/rviz_harmony_video.mp4}
  \footfullcitenomark{Moura2022}
\end{frame}

\begin{frame}{Contact-rich Manipulation}{MPC for non-prehensile pushing}
  \centering
  \movie[
    label=icravideo,
    height=\heightVideoFull,
    % autostart,
    % repeat,
    showcontrols
  ]{\includegraphics[height=\heightVideoFull]{images/pushingMPC.png}}{videos/pushingMPC.mp4}
  \footfullcitenomark{Moura2022}
\end{frame}

\begin{frame}{Contact-rich Manipulation}{RL for non-prehensile pushing}
  \begin{center}
    \underline{Goal-conditioned Parially Observable Markov Decision Process}
    \tikzsetnextfilename{fig_diagram_rl}
    \input{Tikz/fig_diagram_rl.tex}
  \end{center}
  \begin{tikzpicture}[overlay, remember picture]
    % photos of colaborators
    \node[anchor=south east] (juan) at (current page.south east) [xshift=-3mm, yshift=15mm] {
      \includegraphics[height=1.4cm]{images/Juan.png}
    };
    \node (juanName) at (juan.south) [anchor=north, text width=3.5cm, align=center] {
      \textcolor{infoBlue}{\scriptsize\textbf{Juan}}
    };
    \draw[very thick, infoBlue] (juan) circle (0.7cm);
  \end{tikzpicture}
  \footfullcitenomark{Ferrandis2023}
  \footfullcitenomark{Ferrandis2024}
\end{frame}

\begin{frame}{Contact-rich Manipulation}{RL for non-prehensile pushing}
  \centering
  \movie[
    label=irosrobotvideo,
    height=\heightVideoFull,
    % autostart,
    % repeat,
    showcontrols,
  ]{\includegraphics[height=\heightVideoFull]{images/physical_robot.png}}{videos/physical_robot.mp4}
  \footfullcitenomark{Ferrandis2023}
\end{frame}

\begin{frame}{Contact-rich Manipulation}{RL for non-prehensile pushing}
  \centering
  \movie[
    label=corlrobotvideo,
    height=\heightVideoFull,
    % autostart,
    % repeat,
    showcontrols,
  ]{\includegraphics[height=\heightVideoFull]{images/robot_experiments_occlusions.png}}{videos/robot_experiments_occlusions.mp4}
  \footfullcitenomark{Ferrandis2024}
\end{frame}

\begin{frame}{Contact-rich Manipulation}{Sim2Real policy transfer}
  \centering
  \begin{figure}
    \includegraphics[width=0.9\textwidth]{images/marina_corl_diagram.png}
  \end{figure}
  \begin{tikzpicture}[overlay, remember picture]
    % photos of colaborators
    \node[anchor=south east] (marina) at (current page.south east) [xshift=-3mm, yshift=10mm] {
      \includegraphics[height=1.4cm]{images/Marina.png}
    };
    \node (marinaName) at (marina.south) [anchor=north, text width=3.5cm, align=center] {
      \textcolor{infoBlue}{\scriptsize\textbf{Marina}}
    };
    \draw[very thick, infoBlue] (marina) circle (0.7cm);
  \end{tikzpicture}
  \footfullcitenomark{Aoyama2025}
\end{frame}

\begin{frame}{Contact-rich Manipulation}{Sim2Real policy transfer}
  \centering
  \movie[
    label=sliding,
    height=\heightVideoFull,
    showcontrols,
  ]{\includegraphics[height=\heightVideoFull]{images/marina_corl.png}}{videos/marina_corl.mp4}
  \footfullcitenomark{Aoyama2025}
\end{frame}

\begin{frame}[t]
  \begin{columns}[T]
    \begin{column}{0.55\textwidth}
      \centering
      \begin{figure}
        \only<1>{
          \tikzsetnextfilename{fig_landscape_taskspace_contactrich}
          \input{Tikz/fig_landscape_taskspace_contactrich.tex}
        }
        \only<2-3>{
          \tikzsetnextfilename{fig_landscape_wholebody_contactfree}
          \input{Tikz/fig_landscape_wholebody_contactfree.tex}
        }
        \only<4->{
          \tikzsetnextfilename{fig_landscape_wholebody_contactrich}
          \input{Tikz/fig_landscape_wholebody_contactrich.tex}
        }
      \end{figure}
    \end{column}
    \begin{column}{0.45\textwidth}
      \vspace*{5mm}
      \only<1>{
        \begin{itemize}
          \item Explored \textbf{model-based} and \textbf{data-driven} approaches for contact-rich manipulation.
          \item Only \textbf{object-centrinc} reasoning.
        \end{itemize}
      }
      \only<3>{
        \begin{itemize}
          \item \textbf{High number of degrees of freedom} lead to \textbf{\textcolor{infoRed}{high dimensionality}} in the  \textbf{state and action spaces}.
          \item Finding robot configurations in \textbf{confined spaces} and with \textbf{obstacles} results in a \textbf{\textcolor{infoRed}{highly non-linear problem}}.
        \end{itemize}
      }
      \only<5>{
        \begin{itemize}
          \item \textbf{\textcolor{infoRed}{Hybrid dynamics}}
          \item \textbf{\textcolor{infoRed}{Underactuation}}
          \item \textbf{\textcolor{infoRed}{Sim2Real gap}}
          \item \textbf{\textcolor{infoRed}{High dimensionality}}
          \item \textbf{\textcolor{infoRed}{Highly non-linear problem}}
        \end{itemize}
      }
    \end{column}
  \end{columns}
\end{frame}

\begin{frame}{Whole-body Contact-rich Manipulation}
  \begin{figure}
    \centering
    \tikzsetnextfilename{fig_humanoids_problem_representation.}
    \input{Tikz/fig_humanoids_problem_representation.tex}
    % \caption*{Variables of the trajectory to plan.}
  \end{figure}
  \begin{tikzpicture}[overlay, remember picture]
    % photos of colaborators
    \node[anchor=south east] (victor) at (current page.south east) [xshift=-3mm, yshift=10mm] {
      \includegraphics[height=1.4cm]{images/Victor.png}
    };
    \node (victorName) at (victor.south) [anchor=north, text width=3.5cm, align=center] {
      \textcolor{infoBlue}{\scriptsize\textbf{Victor}}
    };
    \draw[very thick, infoBlue] (victor) circle (0.7cm);
  \end{tikzpicture}
  \footfullcitenomark{Leve2024}
\end{frame}

\begin{frame}{Whole-body Contact-rich Manipulation}
  \centering
  \movie[
    label=humanoids,
    height=\heightVideoFull,
    % autostart,
    % repeat,
    % showcontrols
  ]{\includegraphics[height=\heightVideoFull]{images/victor_airec.png}}{videos/victor_airec.mp4}
  \footfullcitenomark{Leve2025}
\end{frame}

\begin{frame}[t]
  \begin{columns}[T]
    \begin{column}{0.55\textwidth}
      \centering
      \begin{figure}
        \tikzsetnextfilename{fig_landscape}
        \input{Tikz/fig_landscape.tex}
      \end{figure}
    \end{column}
    \begin{column}{0.45\textwidth}
      \begin{itemize}
        \item \textbf{Hybrid dynamics}
        \item \textbf{Underactuation}
        \item \textbf{Sim2Real gap}
        \item \textbf{High dimensionality}
        \item \textbf{Highly non-linear problem}
      \end{itemize}
    \end{column}
  \end{columns}
\end{frame}

\section{Project applications}

\begin{frame}{
  UKRI application\footnote{\href{https://www.ukri.org/opportunity/japan-uk-joint-call-for-collaborations-in-advancing-human-centred-ai/}{ukri.org/opportunity/japan-uk-joint-call-for-collaborations-in-advancing-human-centred-ai/}}
  }{Scaling Whole-Body Contact-Rich Interactions for Assistive Robotics: Human Centric Innovations for Embodied AI}
  \begin{center}
    \begin{figure}
      \includegraphics[width=0.7\textwidth]{images/fig_ukri_diagram.pdf}
    \end{figure}
  \end{center}
\end{frame}

\begin{frame}
  \centering
  \movie[
    label=questions,
    height=\heightVideoFull,
    autostart,
    repeat,
  ]{\includegraphics[height=\heightVideoFull]{images/questions.png}}{videos/questions.mp4}
\end{frame}

\begin{frame}[plain, noframenumbering]
  \maketitle
\end{frame}

\end{document}